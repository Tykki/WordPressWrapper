function shorten(a){switch(a){case"mainfloor1":return"f1";case"mainfloor2":return"f2";case"lower":return"ll"}return"err"}function loadFloorXMLDoc(a){var b;var c,d,e,f,g;if(window.XMLHttpRequest){b=new XMLHttpRequest}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){c="";d=b.responseXML.documentElement.getElementsByTagName("FLOORNAME");for(f=0;f<d.length;f++){e=d[f].getElementsByTagName("KEYWORD");if(e[0].firstChild.nodeValue==a){e=d[f].getElementsByTagName("IMAGE");try{g=e[0].firstChild.nodeValue}catch(h){}e=d[f].getElementsByTagName("MAP");try{map_image_useMap=e[0].firstChild.nodeValue}catch(h){}e=d[f].getElementsByTagName("INFO");try{c=e[0].firstChild.nodeValue}catch(h){}}}document.getElementById("summary").innerHTML=c;document.getElementById("img").innerHTML='<img src="'+g+'" alt="map" id="map_image" usemap="'+map_image_useMap+'" class="map">';var j=shorten(a);loadXMLDoc(j);$(".map").maphilight()}};b.open("GET","floors.xml",true);b.send()}function cont(a,b){for(i=0;i<a.length;i++){if(a[i].firstChild.nodeValue==b)return true}return false}function loadXMLDoc(a){var b;var c,d,e,f,g,h;var i=f2=ll="";if(window.XMLHttpRequest){b=new XMLHttpRequest}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){c="";d=b.responseXML.documentElement.getElementsByTagName("SV");for(f=0;f<d.length;f++){e=d[f].getElementsByTagName("KEYWORD");try{c+='<div id="'+e[0].firstChild.nodeValue+'" class="services">'}catch(g){}e=d[f].getElementsByTagName("IMAGE");try{c+='<img src="'+e[0].firstChild.nodeValue+'" alt="header" />'}catch(h){}e=d[f].getElementsByTagName("TITLE");try{c+="<h2>"+e[0].firstChild.nodeValue+"</h2>"}catch(g){}e=d[f].getElementsByTagName("PHONE");try{c+="<strong>Phone: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("HOURS");try{c+="<strong>Hours: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("LOCATION");try{c+="<strong>Location: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("WEBSITE");try{c+='<a href="'+e[0].firstChild.nodeValue+'">'+e[0].firstChild.nodeValue+"</a>"}catch(g){}c=c+"<br /><br /></div>";e=d[f].getElementsByTagName("FLOOR");try{if(cont(e,"F1")){i+=c}if(cont(e,"F2")){f2+=c}if(cont(e,"FB")){ll+=c}}catch(g){}c=""}var j;switch(a){case"f1":j=i;break;case"f2":j=f2;break;case"ll":j=ll;break;default:j="err"}document.getElementById("floor").innerHTML=j;$("area.fancy").fancybox()}};b.open("GET","services.xml",true);b.send()}
