function shorten(a){switch(a){case"mainfloor1":return"f1";case"mainfloor2":return"f2";case"mainfloor3":return"f3";case"mainfloor4":return"f4";case"mainfloorB":return"fb";case"towerfloor1":return"t1";case"towerfloor2":return"t2";case"towerfloor3":return"t3";case"towerfloor4":return"t4";case"towerfloor5":return"t5";case"towerfloor6":return"t6";case"towerfloor7":return"t7";case"towerfloor8":return"t8"}return"err"}function loadFloorXMLDoc(a){var b;var c,d,e,f,g;if(window.XMLHttpRequest){b=new XMLHttpRequest}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){c="";d=b.responseXML.documentElement.getElementsByTagName("FLOORNAME");for(f=0;f<d.length;f++){e=d[f].getElementsByTagName("KEYWORD");if(e[0].firstChild.nodeValue==a){e=d[f].getElementsByTagName("IMAGE");try{g=e[0].firstChild.nodeValue}catch(h){}e=d[f].getElementsByTagName("MAP");try{map_image_useMap=e[0].firstChild.nodeValue}catch(h){}e=d[f].getElementsByTagName("INFO");try{c=e[0].firstChild.nodeValue}catch(h){}}}document.getElementById("summary").innerHTML=c;document.getElementById("img").innerHTML='<img src="'+g+'" alt="map" id="map_image" usemap="'+map_image_useMap+'" class="map">';var j=shorten(a);loadXMLDoc(j);$(".map").maphilight()}};b.open("GET","floors.xml",true);b.send()}function cont(a,b){for(i=0;i<a.length;i++){if(a[i].firstChild.nodeValue==b)return true}return false}function loadXMLDoc(a){var b;var c,d,e,f,g,h;var i=f2=f3=f4=fb=t1=t2=t3=t4=t5=t6=t7=t8="";if(window.XMLHttpRequest){b=new XMLHttpRequest}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){c="";d=b.responseXML.documentElement.getElementsByTagName("SV");for(f=0;f<d.length;f++){e=d[f].getElementsByTagName("KEYWORD");try{c+='<div id="'+e[0].firstChild.nodeValue+'" class="services">'}catch(g){}e=d[f].getElementsByTagName("IMAGE");try{c+='<img src="'+e[0].firstChild.nodeValue+'" alt="header" />'}catch(h){}e=d[f].getElementsByTagName("TITLE");try{c+="<br><h2><strong>"+e[0].firstChild.nodeValue+"</strong></h2><br>"}catch(g){}e=d[f].getElementsByTagName("PHONE");try{c+="<strong>Phone: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("HOURS");try{c+="<strong>Hours: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("LOCATION");try{c+="<strong>Location: </strong>"+e[0].firstChild.nodeValue+"<br/><br/>"}catch(g){}e=d[f].getElementsByTagName("WEBSITE");try{c+='<a href="'+e[0].firstChild.nodeValue+'">'+e[0].firstChild.nodeValue+"</a>"}catch(g){}c=c+"<br /><br /></div>";e=d[f].getElementsByTagName("FLOOR");try{if(cont(e,"F1")){i+=c}if(cont(e,"F2")){f2+=c}if(cont(e,"F3")){f3+=c}if(cont(e,"F4")){f4+=c}if(cont(e,"FB")){fb+=c}if(cont(e,"T1")){t1+=c}if(cont(e,"T2")){t2+=c}if(cont(e,"T3")){t3+=c}if(cont(e,"T4")){t4+=c}if(cont(e,"T5")){t5+=c}if(cont(e,"T6")){t6+=c}if(cont(e,"T7")){t7+=c}if(cont(e,"T8")){t8+=c}}catch(g){}c=""}var j;switch(a){case"f1":j=i;break;case"f2":j=f2;break;case"f3":j=f3;break;case"f4":j=f4;break;case"fb":j=fb;break;case"t1":j=t1;break;case"t2":j=t2;break;case"t3":j=t3;break;case"t4":j=t4;break;case"t5":j=t5;break;case"t6":j=t6;break;case"t7":j=t7;break;case"t8":j=t8;break;default:j="err"}document.getElementById("floor").innerHTML=j;$("area.fancy").fancybox()}};b.open("GET","services.xml",true);b.send()}